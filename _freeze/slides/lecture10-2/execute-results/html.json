{
  "hash": "6f68ff412b50eeb72b9d57eea01279bf",
  "result": {
    "markdown": "---\ntitle: \"Waste Management and Network Models\"\nsubtitle: \"Lecture 22\"\nauthor: \"Vivek Srikrishnan\"\ncourse: \"BEE 4750\"\ninstitution: \"Cornell University\"\ndate: \"October 25, 2023\"\nformat:\n    revealjs:\n        slide-number: c/t\n        show-slide-number: all\n        center-title-slide: true\n        width: 1280\n        height: 720\n        transition: none\n        toc: true\n        toc-depth: 1\n        toc-title: \"Overview\"\n        history: false\n        link-external-newwindow: true\n        theme: ../sass/slides.scss\n        footer: \"[BEE 4750, Environmental Systems Analysis](https://viveks.me/environmental-systems-analysis)\"\n        template-partials:\n            - title-slide.html\n        menu:\n            numbers: true\n        html-math-method: mathjax\n        include-in-header: mathjax-config.html\n        date-format: long\n\nexecute:\n    freeze: auto\n---\n\n\n\n\n\n# Review and Questions\n\n## Mixed Integer Linear Programming\n\n- Problems involving integer constraints break assumptions of LP.\n- Can solve using branch and bound or related algorithms.\n- Iteratively solve a sequence of restricted LPs until integer solution is found.\n\n## Questions\n\n:::: {.columns .center}\n::: {.column width=\"40%\"}\n![](images/vsrikrish-poll.png){fig-alt=\"Poll Everywhere QR Code\" fig-align=\"center\" width=\"100%\"}\n:::\n::: {.column width=60%}\n**Text**: VSRIKRISH to 22333\n\n**URL**: [https://pollev.com/vsrikrish](https://pollev.com/vsrikrish)\n<br><br>\n[See Results](https://www.polleverywhere.com/multiple_choice_polls/qKeig0hHShZYHAOmvZtZm?preview=true&controls=none){preview-link=\"true\"}\n:::\n::::\n\n\n\n# Solid Waste Management\n\n## Waste Load Allocation\n\n:::: {.columns}\n::: {.column width=50%}\nSome relevant questions:\n\n- Where do we send waste?\n- What types of facilities do we build/operate?\n:::\n::: {.column width=50%}\n\n![Waste Management Hierarchy](https://www.epa.gov/sites/default/files/styles/medium/public/2015-08/hierarchy_hierarchy_and_options_pages.png)\n\n::: {.caption}\nSource: [EPA](https://www.epa.gov/homeland-security-waste/waste-management-options-homeland-security-incidents)\n:::\n:::\n::::\n\n## Waste Allocation As A Network Problem\n\nWant to model the flows between sources and sinks!\n\n![Network Representation](figures/waste-network-blank.svg)\n\n## Network Parameterization\n\n:::: {.columns}\n::: {.column width=50%}\n![Network Parameterization](figures/waste-network-params.svg)\n:::\n::: {.column width=50%}\n\n| Variable | Definition |\n| :--: | :------- |\n| $\\color{purple}S_i$ | Waste produced at source $i$ (Mg/day) |\n| $\\color{red}K_j$ | Capacity of disposal $j$ (Mg/day) |\n| $\\color{blue}W_{ij}$ | Waste transported from source $i$ to disposal $j$ (Mg/day) |\n\n:::\n::::\n\n## What Is Missing?\n\nThis network representation takes into account the graph structure of the system, but nothing else.\n\n**What else might we need?**\n\n## System-Specific Information Needs\n\nTo complete the model, need:\n\n- System dynamics (fate & transport);\n- Objectives\n- Costs\n- Management goals and/or regulatory constraints\n\n# Waste Management Example\n\n## Example System\n\n:::: {.columns}\n::: {.column width=50%}\n![Waste Management Example](figures/waste-example-network.svg)\n:::\n::: {.column width=50%}\nThree disposal options:\n\n- Waste-to-Energy (WTE)\n- Materials Recovery Facility (MRF)\n- Landfill (LF)\n:::\n::::\n\n## Waste Management Decision Variables\n\n:::: {.columns}\n::: {.column width=50%}\n![Waste Management Example](figures/waste-example-network.svg)\n:::\n::: {.column width=50%}\n***What are our decision variables?***\n:::\n::::\n\n## Waste Management Decision Variables\n\nVariable | Definition\n:--: | :-----\n$W_{ij}$ | Waste transported from city $i$ to disposal $j$ (Mg/day)\n$R_{kj}$ | Residual waste transported from disposal $k$ to disposal $j$ (Mg/day)\n$Y_j$ | Operational status (on/off) of disposal $j$ (binary)\n\n## Objective: Minimize Total Costs\n\n**What are some components of total system cost?**\n\n## Cost Components\n\n- **Transportation** of waste\n- **Disposal**: fixed costs and variable costs\n\n## Objective: Transportation Costs\n\n:::: {.columns}\n::: {.column width=50%}\n\n| Variable | Definition |\n| :--: | :------- |\n| $a_{ij}$ | Cost of transporting waste from source $i$ to disposal $j$ (\\$/Mg-km) |\n| $l_{ij}$ | Distance between source $i$ and disposal $j$ (km) |\n\n:::\n::: {.column width=50%}\n::: {.fragment .fade-in}\n$$\n\\begin{align}\n&\\text{Transportation Costs} = \\\\[0.5em]\n&\\qquad \\sum_{i \\in I, j \\in J} a_{ij}\\,l_{ij}\\,W_{ij}\n\\end{align}\n$$\n:::\n:::\n::::\n\n## Objective: Disposal Costs\n\n:::: {.columns}\n::: {.column width=50%}\n\n| Variable | Definition |\n| :--: | :------- |\n| $c_j$ | Fixed costs of operating disposal $j$ (\\$/day) |\n| $b_{j}$ | Variable cost of disposing waste at disposal $j$ (\\$/Mg) |\n\n:::\n::: {.column width=50%}\n::: {.fragment .fade-in}\n$$\n\\begin{align}\n&\\text{Disposal Costs} = \\\\[0.5em]\n&\\qquad \\sum_{j \\in J} \\left[c_j + b_j \\sum_{i \\in I} W_{ij}\\right]\n\\end{align}\n$$\n\n::: {.fragment .fade-in}\n**Is this expression for disposal costs right?**\n:::\n:::\n:::\n::::\n\n## Objective: Disposal Costs\n\nThe prior expression is only correct if all disposal facilities are operating.\n\nThe option to not operate disposal facility $j$ means we need new **indicator** variables.\n\n::: {.fragment .fade-in}\n\n$$Y_j = \\begin{cases}0 & \\text{if} \\sum_{i \\in I} W_{ij} = 0 \\\\[0.5em] 1 & \\text{if} \\sum_{i \\in I} W_{ij} > 0\\end{cases}$$\n:::\n\n## Waste Mass-Balance Constraints\n\n1. Need to dispose of all waste from each source $i$:\n    $$\\sum_{j \\in J} W_{ij} = S_i$$\n2. Capacity limit at each disposal site $j$:\n    $$\\sum_{i \\in I} W_{ij} \\leq K_j$$\n\n\n## Problem Formulation\n\n$$\n\\begin{align}\n\\min_{W_{i,j}, {Y_j}} & \\sum_i \\sum_j a_{ij}\\,l_{ij}\\,W_{ij} + \\sum_j \\left[c_jY_j + \\sum_i b_jW_{ij}\\right] & \\\\\n\\text{subject to:} \\quad & Y_j = \\begin{cases}0 & \\text{if } \\sum_{i \\in I} W_{ij} = 0 \\\\ 1 & \\text{if } \\sum_{i \\in I} W_{ij} > 0 \\end{cases} & \\text{(commitment)} \\\\\n& \\sum_i W_{ij} \\leq K_j & \\text{(capacity limit)} \\\\\n& \\sum_j W_{ij} = S_i & \\text{(mass balance)} \\\\\n&  W_{ij} \\geq 0 & \\text{(nonnegativity)}\n\\end{align}\n$$\n\n\n## Facility Costs\n\n:::: {.columns}\n::: {.column width=50%}\n![Waste Management Example](figures/waste-example-network.svg)\n:::\n::: {.column width=50%}\nFacility | Fixed Cost (\\$/yr) | Tipping Cost (\\$/Mg) | Recycling Cost (\\$/Mg recycled) \n:----: | -----: | -----: | ----: \nWTE | 900,000 | 60 | --\nMRF | 400,000 | 5 | 35 \nLF | 700,000 | 40 | --\n\nMRF Recycling Rate: 40%\n\n:::\n::::\n\n## WTE Costs\n\n:::: {.columns}\n::: {.column width=50%}\n![Waste Management Example](figures/waste-example-network.svg)\n:::\n::: {.column width=50%}\n**Fixed Costs**: \\$900,000/yr\n\n**Tipping Cost**: \\$60/Mg handled\n\n::: {.fragment .fade-in}\n***Total WTE Cost (\\$/day)***: $$2466 Y_1 + 60(W_{11} + W_{21} + R_{21})$$\n:::\n:::\n::::\n\n## MRF Costs\n\n:::: {.columns}\n::: {.column width=50%}\n![Waste Management Example](figures/waste-example-network.svg)\n\n**Recycling**: 40%, \\$35/Mg recycled\n\n:::\n::: {.column width=50%}\n**Fixed Costs**: \\$400,000/yr\n\n**Tipping Cost**: \\$5/Mg handled\n\n::: {.fragment .fade-in}\n***Total MRF Cost (\\$/day)***: \n$$\n\\begin{align}\n&1096 Y_2 + 5(W_{12} + W_{22}) + \n\\\\ &\\qquad 0.4(35)(W_{12} + W_{22})\n\\end{align}\n$$\n:::\n:::\n::::\n\n## LF Costs\n\n:::: {.columns}\n::: {.column width=50%}\n![Waste Management Example](figures/waste-example-network.svg)\n:::\n::: {.column width=50%}\n**Fixed Costs**: \\$700,000/yr\n\n**Tipping Cost**: \\$40/Mg handled\n\n::: {.fragment .fade-in}\n***Total LF Cost (\\$/day)***: $$1918 Y_2 + 40(W_{13} + W_{23} + R_{13} + R_{23})$$\n:::\n:::\n::::\n\n## Transportation Costs\n\n:::: {.columns}\n::: {.column width=50%}\n![Waste Management Example](figures/waste-example-network.svg)\n:::\n::: {.column width=50%}\n\n**Transportation Cost**: \\$1.50/Mg-km\n\n***Total Tranportation Cost (\\$/day)***:\n$$\n\\begin{align} \n1.5&{\\Large[}15W_{11} + 5W_{12} + 30W_{13} \\\\\n& \\quad 10W_{21} + 15W_{22} + 25W_{23} \\\\\n& \\quad 18R_{13} + 15R_{21} + 32R_{23}{\\Large]}\n\\end{align}\n$$\n:::\n::::\n\n## Final Objective\n\nCombining the transportation and disposal costs and simplifying:\n$$\n\\begin{align}\n\\min_{W, R, Y} \\qquad & 82.5 W_{11} + 26.5W_{12} + 85W_{13} + 75W_{21} + \\\\[0.25em]\n& \\quad 41.5W_{22} + 77.5W_{23} + 67R_{13} + 82.5R_{21} + \\\\[0.75em]\n& \\quad 88R_{23} + 2466Y_1 + 1096Y_2 + 1918Y_3\n\\end{align}\n$$\n\n## City Mass-Balance Constraints\n\n:::: {.columns}\n::: {.column width=50%}\n![Waste Management Example](figures/waste-example-network.svg)\n:::\n::: {.column width=50%}\n\n**City 1**: $W_{11} + W_{12} + W_{13} = 100$\n\n**City 2**: $W_{21} + W_{22} + W_{23} = 170$\n:::\n::::\n\n## Residual Mass-Balance Constraints\n\n:::: {.columns}\n::: {.column width=50%}\n![Waste Management Example](figures/waste-example-network.svg)\n:::\n::: {.column width=50%}\n\n**Recycling Rate**: 40%\n\n**WTE Residual Ash**: 20%\n\n::: {.fragment .fade-in}\n$R_{13} = 0.2(W_{11} + W_{21} + R_{21})$\n\n::: {.fragment .fade-in}\n$R_{21} + R_{23} = 0.6(W_{12} + W_{22})$\n:::\n:::\n:::\n::::\n\n\n## Disposal Limit Constraints\n\n:::: {.columns}\n::: {.column width=50%}\n![Waste Management Example](figures/waste-example-network.svg)\n:::\n::: {.column width=50%}\n\n**WTE**: $W_{11} + W_{21} + R_{21} \\leq 150$\n\n**MRF**: $W_{12} + W_{22} \\leq 130$\n\n**LF**: $W_{13} + W_{23} + R_{23} + R_{13} \\leq 200$\n\n:::\n::::\n\n## Commitment and Non-Negativity Constraints\n\n$$\n\\begin{align}\nY_1 &= \\begin{cases}0 &\\quad \\text{if } W_{11} + W_{21} + R_{21} = 0 \\\\ 1 & \\quad \\text{else} \\end{cases} \\\\\nY_2 &= \\begin{cases}0 &\\quad \\text{if } W_{21} + W_{22} = 0 \\\\ 1 & \\quad \\text{else} \\end{cases} \\\\\nY_3 &= 1 \\\\[0.5em]\nW_{ij}, R_{ij} &\\geq 0\n\\end{align}$$ \n\n## How To Incorporate Indicator Constraints in JuMP\n\nSome solvers allow you to directly translate indicator constraints into JuMP.  For example, \n\n```julia\n@constraint(waste, commit2, !Y[2] => {W[1,2] + W[2,2] == 0})\n```\n\nimplements \n$$Y_2 = \\begin{cases}0 &\\quad \\text{if } W_{21} + W_{22} = 0 \\\\ 1 & \\quad \\text{else} \\end{cases}\n$$\n\n## How To Incorporate Indicator Constraints in JuMP\n\nHiGHS does not support this type of syntax. So what can we do?\n\n::: {.fragment .fade-in}\nUse a **\"big-M\"** reformulation:\n\n$$MY_1 \\geq  W_{21} + W_{22}$$\n\nwhere $M$ is so large that it is greater than any feasible value of the RHS.\n:::\n\n## Example Solution\n\nAfter putting this all into JuMP (you know how!), optimal objective is \\$26,879/day.\n\n:::: {.columns}\n::: {.column width=20%}\n$Y_1 = 1$\n\n$Y_2 = 1$\n\n$Y_3 = 1$\n:::\n\n::: {.column width=33%}\n$W_{12} = 100$ Mg/day\n\n$W_{23} = 170$ Mg/day\n\n:::\n\n::: {.column width=47%}\n$R_{13} = 7.5$ Mg/day\n\n$R_{21} = 37.5$ Mg/day\n\n$R_{23} = 22.5$ Mg/day\n:::\n::::\n\n## Example Solution\n\n![Waste Management Problem Solution](figures/waste-example-solution.svg)\n\n# Key Takeaways\n\n## Network Problems\n\n- Explicitly model flows between network components;\n- Often are limits on flow or node capacities;\n- Fate & transport dynamics can result in residuals and extra flows.\n- Often are non-obvious results for how to route relevant stocks through network.\n\n**Another example**: power flow modeling through a transmission network.\n\n## Solid Waste Management\n\n- Network induced by fixed transportation routes.\n- Different types of facilities can produce different residual waste products.\n- Extra residual waste can mean facilities have to operate.\n\n**HW 5**: Two twists: Non-homogeneous waste (different ash/recycline rates) and CO~2~ emissions tax.\n\n## Upcoming Schedule\n\n**HW4/Regulatory Report**: Due **Friday** at 9pm.\n\n**HW5**: Will be released on Friday, due 11/10 at 9pm.\n\n**Project Update**: Also due 11/10 at 9pm.\n\n",
    "supporting": [
      "lecture10-2_files/figure-revealjs"
    ],
    "filters": [],
    "includes": {}
  }
}